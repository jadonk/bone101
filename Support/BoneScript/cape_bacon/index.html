<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>BeagleBoard.org - Bacon Cape</title>
  <meta name="keywords" content="Beagle Board, BeagleBoard, beagleboard.org, BeagleBone, BeagleBoard-xM, bealgeboard, open hardware, open source, Linux, computer" />
  <link href="http://feeds.feedburner.com/BeagleBoard" rel="alternate" title="BeagleBoard.org news feed" type="application/atom+xml" />
  <link rel="icon" href="/static/beagle.ico" type="image/x-icon">
  <link rel="shortcut icon" href="/static/beagle.ico" type="image/x-icon">
  <link rel="stylesheet" type="text/css" media="screen" href="/static/common.css" />
  <link rel="stylesheet" type="text/css" media="screen" href="/static/login.css" />
  <link rel="stylesheet" type="text/css" media="screen" href="/static/beagle.css" />
  <script src="/static/bonescript-demo.js"></script>
  <style>
#code {
 position: relative;
 width: 500px;
 padding-left: 0;
 border-radius: 4px;
 border-bottom-right-radius: 0px;
 border-bottom-left-radius: 0px;
 margin-bottom: 0px;
 margin-left: 30px;
 margin-right: 0px;
 align: left;
}
#console-output {
 margin-top: 0px;
 margin-left: 30px;
 width: 496px;
 border: 1px solid #cccccc;
 resize: vertical;
}
  </style>
 </head>
 <body>
 <div class="top">
  <div class="top-header"><a href="http://beagleboard.org"><img src="/static/images/beagle_logo_hdr.gif" alt="beagleboard.org" border="0" width="326" height="60" /></a>
  
  <div class="social">
    <span style="padding-left:8px"><a href="http://facebook.com/beagleboard" name="header_facebook_icon"><img src="/static/images/icon_facebook.png" width="27" height="28" alt="facebook" border="0"/></a></span>
    <span style="padding-left:8px"><a href="http://twitter.com/beagleboardorg" name="header_twitter_icon"><img src="/static/images/icon_twitter.png" width="27" height="28" border="0" alt="twitter"/></a></span>
    <span style="padding-left:8px"><a href="http://www.linkedin.com/groups/BeagleBoardorg-1474607?gid=1474607&mostPopular=&trk=tyah" name="header_linkedin_icon"><img src="/static/images/icon_linkedin.png" width="27" height="28" border="0" alt="linkedin" /></a></span>
    <span style="padding-left:8px"><a href="http://plus.google.com/+beagleboard" name="header_google+_icon"><img src="/static/images/icon_google+.png" width="27" height="28" border="0" alt="google+"/></a></span>
   </div> 
  </div>
 </div>
 <a name="top" id="top"></a>
 <div id="wrapper">
  <div id='cssmenu'>
  </div>
  <div id="content">
   <div id="contentbuffer">

    <!-- NEED TITLE HERE -->
    <h2>Bonescript</h2>

    <div id='side-menu' class="t3_sidebar">
     <ul class="left-menu">
      <strong>Navigation</strong>
      <li><a href="/Support/BoneScript/menu/">Menu contents</a></li>
     </ul>
    </div>
    <div class="t3_content_1">
     <div id='connect-status'></div>
     <div id="content_child">
     <!--- START CONTENT -->

<h1>Bacon Cape</h1>
<p>The Bacon Cape is an add-on board meant to give you access to some
 hardware to help build your understanding of doing basic embedded I/O on
 BeagleBone.
</p>
<h2>Board activity</h2>
<div style="display: table;">
 <div style="display: table-row; width=500px;">
  <div id="led1" style="display: table-cell; height:50px;"></div>
  <div style="display: table-cell; height:50px">
   <div id="slider1" style="width:400px; vertical-align:center;"></div>
   <div id="slider2" style="width:400px; vertical-align:center;"></div>
   <div id="slider3" style="width:400px; vertical-align:center;"></div>
  </div>
 </div>
</div>
<h2>Components</h2>
<ul>
 <li><em>S1</em>: a simple push button provides a digital input
  <ul>
   <li><em>P8_19</em>: digital I/O connection to BeagleBone</li>
   <li>Configured as active-low (low when pressed) and uses and external pull-up</li>
  </ul>
 </li>
 <li><em>D1</em>: an RGB LED provides an indicator for digital output
  <ul>
   <li><em>P9_16</em>: digital I/O connection for <em><font color="blue">BLUE</font></em></li>
   <li><em>P9_14</em>: digital I/O connection for <em><font color="green">GREEN</font></em></li>
   <li><em>P9_42</em>: digital I/O connection for <em><font color="red">RED</font></em></li>
   <li>Configured as active-low (lit when low) using a common anode</li>
  </ul>
 </li>
 <li><em>R10</em>: a slide potentiometer provides an analog input
  <ul>
   <li><em>P9_36</em>: analog input connection to BeagleBone</li>
  </ul>
 </li>
 <li><em>U1</em>: shift register feeding a 7 segment display
  <img src="/static/images/cape-bacon-seg7.png" align="right" />
  <ul>
   <li><em>P9_22</em>: CLOCK</li>
   <li><em>P9_17</em>: LATCH</li>
   <li><em>P9_18</em>: DATA</li>
   <li><em>LED1</em>: connected to shift register output in common anode (active-low) configuration</li>
   <li><em>a</em>: last bit shifted out</li>
   <li><em>h</em>: first bit shifted out</li>
  </ul>
 <li><em>U2</em>: I2C EEPROM connected to I2C2</li>
</ul>
<!--
<h2>Currently running code example</h2>
<script>
    onbonescriptinit = function() {
        $(document).ready(function(){demoRun('code');});
    };
</script>
-->
<h2>Demo
 <button class="dynlink" onclick="demoRun('code')">run</button>
 <button class="dynlink" onclick="demoRestore('code')">restore</button>
</h2>
<pre id="code" class="use-editor" style="height: 1500px;">
console.log('Starting Bacon Cape demo');
var b = require('bonescript');
var s = b.LOW;
var LED_RED = 'P9_42';
var LED_GREEN = 'P9_14';
var LED_BLUE = 'P9_16';
var BUTTON = 'P8_19';
var POT = 'P9_36';

try {
    $('#slider1').slider();
    $('#slider2').slider();
    $('#slider3').slider();
    $('#led1').css('width', '50px');
    $('#led1').css('height', '50px');
    $('#led1').css('background-color', 'rgb(0,0,0)');
} catch(ex) {}
b.pinMode('USR0', b.OUTPUT);
b.pinMode('USR1', b.OUTPUT);
b.pinMode('USR2', b.OUTPUT);
b.pinMode('USR3', b.OUTPUT);
b.pinMode(LED_RED, b.OUTPUT);
b.pinMode(LED_GREEN, b.OUTPUT);
b.pinMode(LED_BLUE, b.OUTPUT);
b.pinMode(BUTTON, b.INPUT);
b.digitalWrite('USR0', b.LOW);
b.digitalWrite('USR1', b.LOW);
b.digitalWrite('USR2', b.LOW);
b.digitalWrite('USR3', b.LOW);
b.analogWrite(LED_RED, 0);
b.analogWrite(LED_GREEN, 0);
b.analogWrite(LED_BLUE, 0);
//b.attachInterrupt(BUTTON, true, b.CHANGE, handleButton);
blink();
$("#slider3").bind("slidechange", function(event, ui) {
    updateRed({value:(ui.value/100.0)});
});

function blink(x) {
    s = (s == b.LOW) ? b.HIGH : b.LOW;
    b.digitalWrite('USR0', s, doAnalogRead);
}

function doAnalogRead() {
    b.digitalRead(BUTTON, updateBlue);
    b.analogRead(POT, updateGreen);
    setTimeout(blink, 100);
}

function updateBlue(x) {
    if(typeof x.value == 'undefined') return;
    updateLED({blue:x.value});
}

function updateGreen(x) {
    if(typeof x.value == 'undefined') return;
    updateLED({green:x.value});
}

function updateRed(x) {
    if(typeof x.value == 'undefined') return;
    updateLED({red:x.value});
}

function updateLED(led) {
    if(typeof led.red == 'number') {
        b.analogWrite(LED_RED, 1-led.red);
        this.red = led.red;
    }
    if(typeof led.green == 'number') {
        b.analogWrite(LED_GREEN, 1-led.green);
        this.green = led.green;
    }
    if(typeof led.blue == 'number') {
        b.analogWrite(LED_BLUE, 1-led.blue);
        this.blue = led.blue;
    }
    try {
        if(typeof this.red == 'undefined') this.red = 0;
        if(typeof this.green == 'undefined') this.green = 0;
        if(typeof this.blue == 'undefined') this.blue = 0;
        var rgb = 'rgb(' + Math.round(this.red*255) + ',' + 
            Math.round(this.green*255) + ',' +
            Math.round(this.blue*255) + ')';
        $('#led1').css('background-color', rgb);
        $("#slider1").slider("option", "value", this.blue*100);
        $("#slider2").slider("option", "value", this.green*100);
    } catch(ex) {}
}
</pre>
<div readonly id='console-output' style='height: 80px;'></div>
<script>
window.onbeforeunload = restore;
function restore() {
    var b = require('bonescript');
    var p = '/sys/class/leds/beaglebone:green:usr';
    b.digitalWrite('USR0', b.LOW);
    b.digitalWrite('USR1', b.LOW);
    b.digitalWrite('USR2', b.LOW);
    b.digitalWrite('USR3', b.LOW);
    b.writeTextFile(p+'0/trigger', 'heartbeat');
    b.writeTextFile(p+'1/trigger', 'mmc0');
    b.writeTextFile(p+'2/trigger', 'cpu0');
    b.writeTextFile(p+'3/trigger', 'mmc1');
    b.detachInterrupt('P8_19');
}
</script>
<h2>See also</h2>
<h3>Topics</h3>
<ul>
 <li><a href="/Support/bone101/#headers">BeagleBone expansion headers</a></li>
 <li><a href="/Support/BoneScript/#analogio">Analog I/O</a></li>
</ul>
<h3>Related functions</h3>
<ul>
 <li><a href="/Support/BoneScript/#require">require</a></li>
 <li><a href="/Support/BoneScript/pinMode/">pinMode</a></li>
 <li><a href="/Support/BoneScript/analogWrite/">analogWrite</a></li>
 <li><a href="/Support/BoneScript/analogRead/">analogRead</a></li>
 <li><a href="/Support/BoneScript/digitalWrite/">digitalWrite</a></li>
 <li><a href="/Support/BoneScript/digitalRead/">digitalRead</a></li>
</ul>

     <!--- START FOOTER -->
     </div>
    </div>
    <div class="footer">
    <div class="social">
     <span style="padding-left:8px"><a href="http://facebook.com/beagleboard" name="header_facebook_icon"><img src="/static/images/icon_facebook.png" width="27" height="28" alt="facebook" border="0"/></a></span>
     <span style="padding-left:8px"><a href="http://twitter.com/beagleboardorg" name="header_twitter_icon"><img src="/static/images/icon_twitter.png" width="27" height="28" border="0" alt="twitter"/></a></span>
     <span style="padding-left:8px"><a href="http://www.linkedin.com/groups/BeagleBoardorg-1474607?gid=1474607&mostPopular=&trk=tyah" name="header_linkedin_icon"><img src="/static/images/icon_linkedin.png" width="27" height="28" border="0" alt="linkedin" /></a></span>
     <span style="padding-left:8px"><a href="http://plus.google.com/+beagleboard" name="header_google+_icon"><img src="/static/images/icon_google+.png" width="27" height="28" border="0" alt="google+"/></a></span>
    </div>
    <div id="login"></div>
    <div id="footer-col1">
     <ul>
      <li><a target="_blank" href="http://beagleboard.org/about">About Us</a></li>
      <li><a target="_blank" href="http://beagleboard.org/support">Support</a></li>
      <li><a target="_blank" href="http://beagleboard.org/buy">Distributors</a></li>
     </ul>
    </div>
    <div id="footer-col2">
     <ul>
      <li><a target="_blank" href="http://beagleboard.org/chat">Live chat</a></li>
      <li><a target="_blank" href="http://beagleboard.org/discuss">Mailing list</a></li>
      <li><a target="_blank" href="http://beagleboard.org/project">Projects</a></li>
     </ul>
    </div>
    <div id="footer-col3">
     <ul>
      <li><a target="_blank" href="http://beagleboard.org/privacy">Privacy Policy</a></li>
      <li><a target="_blank" href="http://beagleboard.org/terms">Terms of Use</a></li>
     </ul>
    </div>
    <div id="cc"><a href="http://creativecommons.org/about/license/" target="_blank"><img src="/static/images/88x31.png" alt="Creative Commons - Conditions - Attribution and Share Alike" border="0" width="88" height="31" /></a><span style="padding-left:8px">Except where otherwise noted, content on this site is licensed under a Creative Commons Attribution-Share Alike 3.0 license </span></div>
   </div>
  </div>
 </div>
 <div id="fb-root"></div>
 </body>
</html>
